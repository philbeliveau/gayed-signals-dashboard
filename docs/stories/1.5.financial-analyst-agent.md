# Story 1.5: financial-analyst-agent

## Status
Draft

## Story
**As a** financial professional,
**I want** a specialized Financial Analyst AutoGen agent that leverages existing Gayed signals,
**so that** I receive quantitative market analysis with historical context and confidence levels.

## Acceptance Criteria
1. Financial Analyst agent extends existing `src/domains/ai-agents/agents/agents/financial-agent.ts` patterns but uses AutoGen framework
2. Agent has direct access to current Gayed signal calculations from `SignalOrchestrator`
3. Agent incorporates existing enhanced market data from `EnhancedMarketClient`
4. Agent provides specific metrics, historical context, and confidence levels using current data sources
5. Agent personality and response patterns optimized for financial advisory use cases
6. Agent can analyze current signal states (Risk-On/Risk-Off/Neutral) with detailed reasoning
7. Agent responses include specific numerical data from existing signal calculations
8. Agent maintains conversation context and can reference previous analysis
9. Agent integrates with existing performance monitoring and error handling
10. Agent output format compatible with current dashboard display requirements

## Tasks / Subtasks
- [ ] Extend existing financial-agent.ts with AutoGen (AC: 1)
  - [ ] Analyze current financial-agent.ts patterns at `src/domains/ai-agents/agents/agents/financial-agent.ts`
  - [ ] Determine integration approach: extend MCP-based agent vs. create new AutoGen agent
  - [ ] Implement AutoGen-based Financial Analyst agent
- [ ] Connect to Gayed signal data sources (AC: 2, 3)
  - [ ] Integrate with SignalOrchestrator
  - [ ] Connect to EnhancedMarketClient
- [ ] Implement financial analysis capabilities (AC: 4, 6, 7)
  - [ ] Add metrics and confidence level calculations
  - [ ] Implement signal state analysis with reasoning
  - [ ] Include numerical data in responses
- [ ] Optimize for financial advisory use (AC: 5, 8)
  - [ ] Design agent personality for financial context
  - [ ] Implement conversation context maintenance
- [ ] Integrate with existing systems (AC: 9, 10)
  - [ ] Connect to performance monitoring
  - [ ] Ensure dashboard-compatible output format

## Dev Notes

### Relevant Source Tree Info
- `src/domains/ai-agents/agents/agents/financial-agent.ts` - Existing MCP-based fact-checking agent
- `src/domains/trading-signals/engines/orchestrator.ts` - SignalOrchestrator for Gayed signal calculations
- `src/domains/market-data/services/enhanced-market-client.ts` - EnhancedMarketClient for market data
- Current dashboard display components for output format requirements

### MCP Integration Strategy
Current financial-agent.ts is MCP-based with Perplexity, web-search, and trader MCP services. AutoGen integration approach:
- **Option A**: Extend existing MCP agent with AutoGen conversation capabilities
- **Option B**: Create new AutoGen agent that can invoke existing MCP services
- **Recommended**: Option B for cleaner separation while preserving MCP functionality

### Agent Personality Design
Financial Analyst agent should provide:
- Quantitative analysis with specific metrics
- Historical context for current signals
- Confidence levels based on data quality
- Professional advisory tone suitable for financial professionals

### Key Constraints
- Must maintain existing signal calculation accuracy
- Must preserve existing MCP integrations (Perplexity, web-search, trader MCP)
- Output must be compatible with current dashboard
- Agent responses should include specific numerical data
- Conversation context must be maintained across interactions
- Never use fallback or synthetic data - maintain financial-grade data integrity

### Testing
**Testing Standards:**
- Unit tests for agent initialization and configuration
- Integration tests with SignalOrchestrator and EnhancedMarketClient
- End-to-end tests for financial analysis conversations
- Performance tests for response time and accuracy
- Regression tests for existing financial-agent.ts functionality

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-21 | 1.0 | Initial story creation | John (PM) |
| 2025-01-28 | 1.1 | Corrected file paths and added MCP integration strategy | Sarah (PO) |

## Dev Agent Record
_(This section is owned by dev-agent and can only be modified by dev-agent)_

## QA Results
_(This section is owned by qa-agent and can only be modified by qa-agent)_