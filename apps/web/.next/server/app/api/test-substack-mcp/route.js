(()=>{var e={};e.id=438,e.ids=[438],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15666:(e,t,n)=>{"use strict";n.r(t),n.d(t,{patchFetch:()=>y,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>h});var s={};n.r(s),n.d(s,{GET:()=>u,POST:()=>d});var a=n(48106),r=n(48819),i=n(12050),o=n(4235);class c{async conductDebate(e,t){console.log(`🎯 Starting simplified debate for claim: ${t}`);let n=[],s=await this.evidenceGatheringRound(e,t,1);if(n.push(s),s.arguments.some(e=>e.evidence.length>0)){let a=await this.crossExaminationRound(e,t,s.arguments,2);n.push(a)}let a=await this.consensusBuildingRound(e,t,n,3);n.push(a);let r=this.calculateFinalVeracity(n);return{claimId:t,finalVeracity:r.veracity,confidence:r.confidence,consensusLevel:r.consensusLevel,rounds:n}}async evidenceGatheringRound(e,t,n){let s=new Date;console.log(`📡 Round ${n}: Gathering evidence from MCP sources...`);let a=[],[r,i,o]=await Promise.allSettled([this.runWebSearchAgent(e),this.runPerplexityAgent(e),this.runSubstackAgent(e)]);"fulfilled"===r.status?a.push(r.value):(console.warn("WebSearch agent failed:",r.reason),a.push(this.createFailedArgument("websearch-agent","WebSearch MCP failed"))),"fulfilled"===i.status?a.push(i.value):(console.warn("Perplexity agent failed:",i.reason),a.push(this.createFailedArgument("perplexity-agent","Perplexity MCP failed"))),"fulfilled"===o.status?a.push(o.value):(console.warn("Substack agent failed:",o.reason),a.push(this.createFailedArgument("substack-agent","Substack MCP failed")));let c=new Date;return{id:`round-${t}-${n}`,roundNumber:n,roundType:"EVIDENCE_GATHERING",arguments:a,duration:c.getTime()-s.getTime(),startedAt:s,completedAt:c}}async crossExaminationRound(e,t,n,s){let a=new Date;console.log(`⚖️ Round ${s}: Cross-examining evidence...`);let r=await this.runSynthesisAgent(e,n),i=new Date;return{id:`round-${t}-${s}`,roundNumber:s,roundType:"CROSS_EXAMINATION",arguments:[r],duration:i.getTime()-a.getTime(),startedAt:a,completedAt:i}}async consensusBuildingRound(e,t,n,s){let a=new Date;console.log(`🎯 Round ${s}: Building final consensus...`);let r=n.flatMap(e=>e.arguments),i=this.buildFinalConsensus(r),o=new Date;return{id:`round-${t}-${s}`,roundNumber:s,roundType:"CONSENSUS",arguments:[i],duration:o.getTime()-a.getTime(),startedAt:a,completedAt:o}}async runWebSearchAgent(e){try{console.log("\uD83D\uDD0D WebSearch Agent: Searching web sources...");let e=[{source:"WebSearch MCP",content:"Evidence gathered from web search will appear here",credibility:75,supportLevel:"NEUTRAL"}];return{agentId:"websearch-agent",position:"NEUTRAL",evidence:e,reasoning:"WebSearch MCP provides general web-based evidence for fact verification",confidence:70*(e.length>0)}}catch(e){return console.error("WebSearch agent error:",e),this.createFailedArgument("websearch-agent","WebSearch execution failed")}}async runPerplexityAgent(e){try{console.log("\uD83E\uDDE0 Perplexity Agent: Researching authoritative sources...");let e=[{source:"Perplexity MCP",content:"Academic and authoritative evidence will appear here",credibility:90,supportLevel:"NEUTRAL"}];return{agentId:"perplexity-agent",position:"NEUTRAL",evidence:e,reasoning:"Perplexity MCP provides academic and authoritative source verification",confidence:85*(e.length>0)}}catch(e){return console.error("Perplexity agent error:",e),this.createFailedArgument("perplexity-agent","Perplexity execution failed")}}async runSubstackAgent(e){try{console.log("\uD83D\uDCF0 Substack Agent: Searching newsletters and independent journalism...");let e=[{source:"Substack MCP",content:"Newsletter and independent journalism analysis will appear here",credibility:80,supportLevel:"NEUTRAL"}];return{agentId:"substack-agent",position:"NEUTRAL",evidence:e,reasoning:"Substack MCP provides independent journalism and newsletter perspectives",confidence:75*(e.length>0)}}catch(e){return console.error("Substack agent error:",e),this.createFailedArgument("substack-agent","Substack execution failed")}}async runSynthesisAgent(e,t){console.log("\uD83D\uDD17 Synthesis Agent: Analyzing evidence conflicts...");let n=t.flatMap(e=>e.evidence),s=this.identifyEvidenceConflicts(n);return{agentId:"synthesis-agent",position:"NEUTRAL",evidence:[{source:"Synthesis Analysis",content:`Analyzed ${n.length} pieces of evidence. Found ${s.length} conflicts.`,credibility:95,supportLevel:"NEUTRAL"}],reasoning:`Cross-referenced evidence from ${t.length} agents to identify consistency patterns`,confidence:80}}createFailedArgument(e,t){return{agentId:e,position:"NEUTRAL",evidence:[],reasoning:t,confidence:0}}identifyEvidenceConflicts(e){let t=e.filter(e=>"SUPPORTS"===e.supportLevel).length,n=e.filter(e=>"OPPOSES"===e.supportLevel).length;return t>0&&n>0?["Support vs Opposition conflict detected"]:[]}buildFinalConsensus(e){let t=e.flatMap(e=>e.evidence).length;return{agentId:"consensus",position:"NEUTRAL",evidence:[{source:"Final Consensus",content:`Consensus reached based on ${t} pieces of evidence from 4 specialized agents`,credibility:95,supportLevel:"NEUTRAL"}],reasoning:"Final consensus built from multi-agent evidence analysis",confidence:e.reduce((e,t)=>e+t.confidence,0)/e.length}}calculateFinalVeracity(e){let t=e.flatMap(e=>e.arguments.flatMap(e=>e.evidence));return 0===t.length?{veracity:"INSUFFICIENT_EVIDENCE",confidence:0,consensusLevel:0}:{veracity:"PARTIALLY_TRUE",confidence:t.reduce((e,t)=>e+t.credibility,0)/t.length,consensusLevel:75}}constructor(){this.agents=[{id:"websearch-agent",name:"Web Search Agent",type:"web_search",specialization:"General web research and current information"},{id:"perplexity-agent",name:"Perplexity Agent",type:"perplexity",specialization:"Academic research and authoritative sources"},{id:"substack-agent",name:"Substack Agent",type:"substack",specialization:"Newsletter and independent journalism analysis"},{id:"synthesis-agent",name:"Synthesis Agent",type:"synthesis",specialization:"Evidence synthesis and consensus building"}]}}let l=new c;async function u(e){try{console.log("\uD83E\uDDEA Testing Substack MCP Integration API...");let{searchParams:t}=new URL(e.url),n=t.get("claim")||"AI models will significantly impact programming within the next 5 years",s=`test-${Date.now()}`;console.log(`🎯 Testing claim: "${n}"`);let a=await l.conductDebate(n,s),r=a.rounds.flatMap(e=>e.arguments).filter(e=>"substack-agent"===e.agentId),i=r.length>0,c={success:!0,testClaim:n,claimId:s,results:{finalVeracity:a.finalVeracity,confidence:a.confidence,consensusLevel:a.consensusLevel,totalRounds:a.rounds.length,substackIntegration:{enabled:i,arguments:r.length,details:r.map(e=>({reasoning:e.reasoning,evidence:e.evidence.length,confidence:e.confidence,position:e.position}))}},agentSummary:a.rounds.flatMap(e=>e.arguments).reduce((e,t)=>(e[t.agentId]||(e[t.agentId]={count:0,totalConfidence:0}),e[t.agentId].count++,e[t.agentId].totalConfidence+=t.confidence,e[t.agentId].avgConfidence=e[t.agentId].totalConfidence/e[t.agentId].count,e),{})};return o.NextResponse.json(c)}catch(e){return console.error("❌ Substack MCP test failed:",e),o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error",details:e instanceof Error?e.stack:"No stack trace available"},{status:500})}}async function d(e){try{let{claim:t}=await e.json();if(!t)return o.NextResponse.json({success:!1,error:"Claim is required"},{status:400});return u(new o.NextRequest(e.url+`?claim=${encodeURIComponent(t)}`))}catch(e){return o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Invalid request body"},{status:400})}}let p=new a.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/test-substack-mcp/route",pathname:"/api/test-substack-mcp",filename:"route",bundlePath:"app/api/test-substack-mcp/route"},resolvedPagePath:"/Users/philippebeliveau/Desktop/Notebook/gayed-signals-dashboard/apps/web/src/app/api/test-substack-mcp/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:h,serverHooks:f}=p;function y(){return(0,i.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:h})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48106:(e,t,n)=>{"use strict";e.exports=n(44870)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},80408:()=>{},87032:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),s=t.X(0,[620],()=>n(15666));module.exports=s})();