(()=>{var e={};e.id=352,e.ids=[352],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48106:(e,t,a)=>{"use strict";e.exports=a(44870)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63307:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>h,routeModule:()=>u,serverHooks:()=>g,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{GET:()=>c,POST:()=>n});var s=a(48106),o=a(48819),i=a(12050),l=a(4235);async function n(e){try{let{startDate:t,endDate:a}=await e.json();console.log("\uD83E\uDDEA Running DEMO lumber/gold backtesting with sample data...");let r=function(e,t){let a=new Date(e),r=Math.floor((new Date(t).getTime()-a.getTime())/864e5),s=[],o=[],i=45,l=180;for(let e=0;e<r;e++){let t=new Date(a.getTime()+24*e*36e5),r=t.toISOString().split("T")[0];if(0===t.getDay()||6===t.getDay())continue;let n=(Math.random()-.5)*.02,d=1.5*n+(Math.random()-.5)*.03,c=-.3*n+(Math.random()-.5)*.015;i*=1+d,l*=1+c,s.push({date:r,symbol:"WOOD",close:Math.round(100*i)/100,volume:Math.floor(5e5+1e6*Math.random())}),o.push({date:r,symbol:"GLD",close:Math.round(100*l)/100,volume:Math.floor(5e6+1e7*Math.random())})}return{WOOD:s,GLD:o}}(t,a),s=await d(r,t,a);return s.demo={notice:"DEMO MODE: Using realistic sample data structure",realSystem:"Switch to /api/backtest-lumber-gold for real Yahoo Finance data",dataSource:"Generated sample data with realistic correlations and volatility"},l.NextResponse.json(s)}catch(e){return l.NextResponse.json({error:e instanceof Error?e.message:"Demo backtesting failed"},{status:500})}}async function d(e,t,a){let r=function(e,t){let a=[],r=new Map(e.map(e=>[e.date,e.close])),s=new Map(t.map(e=>[e.date,e.close]));for(let t of e.map(e=>e.date).filter(e=>s.has(e)).sort()){let e=r.get(t),o=s.get(t);e&&o&&a.push({date:t,lumberPrice:e,goldPrice:o})}return a}(e.WOOD,e.GLD),s=[],o=[],i={lumber:r.map(e=>({date:e.date,price:e.lumberPrice})),gold:r.map(e=>({date:e.date,price:e.goldPrice})),ratio:[],signals:[]},l={cash:1e5,shares:0},n=null;for(let e=91;e<r.length;e++){let t,a=r[e],d=r[e-91],c=a.lumberPrice/d.lumberPrice/(a.goldPrice/d.goldPrice),u=c>1?"Risk-On":"Risk-Off",p="Risk-On"===u?"WOOD":"GLD",m="Risk-On"===u?a.lumberPrice:a.goldPrice,g=Math.abs(c-1);if(t=g>.15?"Strong":g>.05?"Moderate":"Weak",o.push({date:a.date,lumberPrice:a.lumberPrice,goldPrice:a.goldPrice,lumberGoldRatio:c,signal:u,strength:t}),i.ratio.push({date:a.date,ratio:c}),n!==p&&"Weak"!==t){if(n&&l.shares>0){let e="WOOD"===n?a.lumberPrice:a.goldPrice;l.cash=l.shares*e,s.push({date:a.date,action:"SELL",symbol:n,price:e,signal:u,lumberGoldRatio:c,reasoning:`Close ${n} position - Signal changed to ${u}`})}l.shares=l.cash/m,l.cash=0,n=p,s.push({date:a.date,action:"BUY",symbol:p,price:m,signal:u,lumberGoldRatio:c,reasoning:`Buy ${p} - L/G ratio: ${c.toFixed(3)} (${u})`}),i.signals.push({date:a.date,signal:`${u} (${p})`,price:m})}}let d=r[r.length-1],c="WOOD"===n?d.lumberPrice:d.goldPrice,u=(l.shares*c+l.cash-1e5)/1e5,p=Math.pow(1+u,365/((new Date(a).getTime()-new Date(t).getTime())/864e5))-1,m=[],g=1e5;for(let e of s)if("SELL"===e.action){let t=e.price*l.shares,a=(t-g)/g;m.push(a),g=t}let h=m.filter(e=>e>0).length,b=m.length>0?h/m.length:0,f=1e5,k=0;for(let e=0;e<o.length;e++){let t=1e5*(1+u*(e/o.length));t>f&&(f=t);let a=(f-t)/f;a>k&&(k=a)}let y=m.reduce((e,t)=>e+t,0)/m.length||0,D=Math.sqrt(m.reduce((e,t)=>e+Math.pow(t-y,2),0)/m.length||0),O=D>0?(p-.02)/(D*Math.sqrt(252)):0;return{strategy:"Lumber/Gold Ratio Strategy (DEMO)",symbols:["WOOD","GLD"],timeframe:{start:t,end:a},performance:{totalReturn:u,annualizedReturn:p,sharpeRatio:O,maxDrawdown:k,winRate:b,totalTrades:s.length},trades:s,signalHistory:o,chartData:i}}async function c(){return l.NextResponse.json({strategy:"Lumber/Gold Ratio Backtesting (DEMO)",description:"Demonstrates real system with sample data",note:"Uses realistic sample data to show how the system works",realEndpoint:"/api/backtest-lumber-gold (uses Yahoo Finance)",calculation:"Same 91-day lookback calculation as real system"})}let u=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/backtest-lumber-gold-demo/route",pathname:"/api/backtest-lumber-gold-demo",filename:"route",bundlePath:"app/api/backtest-lumber-gold-demo/route"},resolvedPagePath:"/Users/philippebeliveau/Desktop/Notebook/gayed-signals-dashboard/apps/web/src/app/api/backtest-lumber-gold-demo/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:p,workUnitAsyncStorage:m,serverHooks:g}=u;function h(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:m})}},80408:()=>{},87032:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[620],()=>a(63307));module.exports=r})();