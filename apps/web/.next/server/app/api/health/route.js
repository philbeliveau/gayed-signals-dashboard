"use strict";(()=>{var e={};e.id=772,e.ids=[772],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{e.exports=require("url")},94433:(e,t,s)=>{s.r(t),s.d(t,{patchFetch:()=>k,routeModule:()=>m,serverHooks:()=>S,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>y});var a={};s.r(a),s.d(a,{GET:()=>p,OPTIONS:()=>g});var n=s(48106),i=s(48819),r=s(12050),l=s(4235);class o{static{this.REQUIRED_SYMBOLS=["SPY","XLU","WOOD","GLD","IEF","TLT","^VIX"]}static{this.DEFAULT_CONFIG={signals:{utilities_spy:{enabled:!0,weight:1,parameters:{}},lumber_gold:{enabled:!0,weight:1,parameters:{}},treasury_curve:{enabled:!0,weight:1,parameters:{}},vix_defensive:{enabled:!0,weight:1,parameters:{}},sp500_ma:{enabled:!0,weight:1,parameters:{}}},consensus:{method:"majority",minimumSignals:3}}}static getRequiredSymbols(){return[...this.REQUIRED_SYMBOLS]}static calculateFastSignals(e,t){let s=[];try{let t=this.calculateUtilitiesSpySignal(e);t&&s.push(t)}catch(e){console.error("Error calculating fast signals:",e)}return s}static calculateAllSignals(e,t=this.DEFAULT_CONFIG){let{marketData:s}=e,a=[];try{if(t.signals.utilities_spy.enabled){let e=this.calculateUtilitiesSpySignal(s);e&&a.push(e)}if(t.signals.lumber_gold.enabled){let e=this.calculateLumberGoldSignal(s);e&&a.push(e)}}catch(e){console.error("Error calculating all signals:",e)}return a}static calculateConsensusSignal(e,t=this.DEFAULT_CONFIG){let s,a,n=e.filter(e=>null!==e);if(n.length<t.consensus.minimumSignals)return{consensus:"Mixed",confidence:0,riskOnCount:0,riskOffCount:0,neutralCount:0,signals:n,timestamp:new Date().toISOString()};let i=n.filter(e=>"Risk-On"===e.signal).length,r=n.filter(e=>"Risk-Off"===e.signal).length,l=n.filter(e=>"Neutral"===e.signal).length;switch(t.consensus.method){case"majority":default:({consensus:s,confidence:a}=this.calculateMajorityConsensus(i,r,l,n.length));break;case"weighted":({consensus:s,confidence:a}=this.calculateWeightedConsensus(n,t));break;case"confidence-based":({consensus:s,confidence:a}=this.calculateConfidenceBasedConsensus(n))}return{consensus:s,confidence:a,riskOnCount:i,riskOffCount:r,neutralCount:l,signals:n,timestamp:new Date().toISOString()}}static calculateUtilitiesSpySignal(e){let t=e.XLU,s=e.SPY;return t&&s?UtilitiesSpySignal.calculateFromMarketData(t,s):null}static calculateLumberGoldSignal(e){let t=e.WOOD,s=e.GLD;return t&&s?LumberGoldSignal.calculateFromMarketData(t,s):null}static calculateMajorityConsensus(e,t,s,a){let n=a/2;return e>n?{consensus:"Risk-On",confidence:e/a}:t>n?{consensus:"Risk-Off",confidence:t/a}:{consensus:"Mixed",confidence:Math.max(e,t)/a}}static calculateWeightedConsensus(e,t){let s=0,a=0,n=0;for(let i of e){let e=t.signals[i.type],r=e?.weight||1;n+=r,"Risk-On"===i.signal?s+=r:"Risk-Off"===i.signal&&(a+=r)}let i=s/n,r=a/n;return i>.5?{consensus:"Risk-On",confidence:i}:r>.5?{consensus:"Risk-Off",confidence:r}:{consensus:"Mixed",confidence:Math.max(i,r)}}static calculateConfidenceBasedConsensus(e){let t=0,s=0,a=0;for(let n of e){let e=n.confidence;a+=e,"Risk-On"===n.signal?t+=e:"Risk-Off"===n.signal&&(s+=e)}if(0===a)return{consensus:"Mixed",confidence:0};let n=t/a,i=s/a;return n>.5?{consensus:"Risk-On",confidence:n}:i>.5?{consensus:"Risk-Off",confidence:i}:{consensus:"Mixed",confidence:Math.max(n,i)}}static getConfiguration(){return{signalsImplemented:["utilities_spy","lumber_gold"],signalsPlanned:["treasury_curve","vix_defensive","sp500_ma"],consensusMethods:["majority","weighted","confidence-based"],minimumDataRequirements:{utilities_spy:22,lumber_gold:92,treasury_curve:22,vix_defensive:22,sp500_ma:201}}}}var u=s(95956),c=s(49165);s(88010);var d=s(87046);async function h(e){let t=`health_${Date.now()}`,s=Date.now();try{let[e,a,n]=await Promise.all([u.y1.healthCheck(),c.$n.getHealthStatus(),d._V.getSecurityStats()]),i=Date.now()-s,r={status:e.status,timestamp:new Date().toISOString(),requestId:t,responseTime:i,services:{yahoo_finance:{status:e.details.yahoo_finance?"healthy":"unhealthy",responseTime:e.responseTime},risk_management:{status:a.status,uptime:a.uptime,circuitBreaker:a.circuitBreakerState},data_fallback:{status:e.details.data_fallback?"healthy":"degraded"},security:{status:"healthy",rateLimiting:n?.rateLimiting||{},suspiciousIPs:n?.suspiciousIPs?.length||0}},metrics:a.metrics};return l.NextResponse.json(r,{status:"unhealthy"===e.status?503:200,headers:{"X-Request-ID":t,"X-Health-Status":e.status}})}catch(e){return l.NextResponse.json({status:"error",error:e instanceof Error?e.message:"Health check failed",timestamp:new Date().toISOString(),requestId:t},{status:503,headers:{"X-Request-ID":t}})}}async function p(e){return h(e)}async function g(e){return l.NextResponse.json({},{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Max-Age":"86400"}})}let m=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/health/route",pathname:"/api/health",filename:"route",bundlePath:"app/api/health/route"},resolvedPagePath:"/Users/philippebeliveau/Desktop/Notebook/gayed-signals-dashboard/apps/web/src/app/api/health/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:f,workUnitAsyncStorage:y,serverHooks:S}=m;function k(){return(0,r.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:y})}},94735:e=>{e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[620,149],()=>s(94433));module.exports=a})();