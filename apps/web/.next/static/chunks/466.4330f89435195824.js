"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{2466:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(54568),l=s(7620),n=s(30149),i=s(83957),r=s(34503),d=s(17296),c=s(45155),o=s(71402),m=s(69847),h=s(57617),x=s(91377),g=s(58186),u=s(65440),f=s(44057);let p=(e,t)=>(t?["var(--theme-primary)","var(--theme-accent)","var(--theme-success)","var(--theme-info)","#3B82F6","#8B5CF6","#10B981","#059669","#DC2626","#0F766E","#0EA5E9","#7C3AED","#0D9488"]:["var(--theme-warning)","var(--theme-text-muted)","var(--theme-danger)","#F59E0B","#6B7280","#0891B2","#FBBF24","#A3A3A3","#4B5563","#9CA3AF","#065F46"])[({SPY:0,QQQ:1,IWM:2,VTI:3,SPXL:4,WOOD:0,CUT:5,XLI:6,XLF:7,MTUM:8,QUAL:9,XLU:0,GLD:1,TLT:2,SPLV:3,IAU:4,PDBC:5,IEF:6,VGIT:7,SHY:8,USMV:9})[e]||0]||(t?"var(--theme-primary)":"var(--theme-warning)"),j={SPY:"Risk-On",QQQ:"Risk-On",IWM:"Risk-On",VTI:"Risk-On",SPXL:"Risk-On",WOOD:"Risk-On",CUT:"Risk-On",XLI:"Risk-On",XLF:"Risk-On",MTUM:"Risk-On",QUAL:"Risk-On",XLU:"Risk-Off",GLD:"Risk-Off",TLT:"Risk-Off",IEF:"Risk-Off",VGIT:"Risk-Off",SHY:"Risk-Off",IAU:"Risk-Off",PDBC:"Risk-Off",SPLV:"Risk-Off",USMV:"Risk-Off"};function b(e){var t,s,b,D,v,N,y,k,R,w,T,S,O,E,G,B,F,U,A,L,C,I,P,Y,M,X,z,W,Q,V,_,H;let{config:K}=e,[q,J]=(0,l.useState)(null),[Z,$]=(0,l.useState)(!1),[ee,et]=(0,l.useState)(null),[es,ea]=(0,l.useState)("prices");console.log("UniversalStrategyChart rendered with config:",{symbols:K.symbols,signals:K.signals,startDate:K.startDate,endDate:K.endDate});let el=(0,l.useCallback)(async()=>{$(!0),et(null);try{let t,s=await fetch("/api/signals");if(!s.ok)throw Error("Failed to fetch signals data");let a=await s.json(),l=null;try{let t=await fetch("http://localhost:5001/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbols:K.symbols,startDate:K.startDate,endDate:K.endDate,signals:K.signals})});if(t.ok){var e;l=await t.json(),console.log("Got Python service data with",(null==(e=l.timeline)?void 0:e.length)||0,"timeline events")}}catch(e){console.log("Python service unavailable, using enhanced signal generation...")}let n=await en();l&&l.timeline&&l.timeline.length>0?(t=l.timeline.map(e=>({date:e.date,strategy:e.signal.replace("/","_").toLowerCase(),signal:e.value,strength:"Moderate",confidence:.8,changeReason:"Market analysis"})),console.log("Using Python service timeline with",t.length,"events")):t=ei(a);let i=er(n,t),r=(null==l?void 0:l.performance)||ed(i,K.initialCash),d={strategy:"Multi-Strategy Analysis (".concat(K.signals.join(", "),")"),symbols:K.symbols,signals:K.signals,timeframe:{start:K.startDate,end:K.endDate},performance:r,trades:i,chartData:n,signalTimeline:t};console.log("Chart data points:",n.length),console.log("Signal timeline events:",t.length),console.log("Trading history:",i.length),console.log("Sample signal timeline:",t.slice(0,3)),console.log("Sample trades:",i.slice(0,3)),J(d)}catch(e){et(e instanceof Error?e.message:"Failed to load real market data")}finally{$(!1)}},[K]);(0,l.useEffect)(()=>{K.symbols.length>0&&K.signals.length>0&&el()},[el]);let en=async()=>{try{var e,t,s,a;console.log("\uD83D\uDD0D DEBUGGING: Fetching data for date range ".concat(K.startDate," to ").concat(K.endDate)),console.log("\uD83D\uDD0D DEBUGGING: Symbols requested: ".concat(K.symbols.join(", ")));try{let s=await fetch("http://localhost:5001/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbols:K.symbols,startDate:K.startDate,endDate:K.endDate,signals:K.signals})});if(s.ok){let a=await s.json();if(a.chartData&&a.chartData.length>0){console.log("\uD83D\uDD0D DEBUGGING: Python service returned ".concat(a.chartData.length," data points"));let s=null==(e=a.chartData[0])?void 0:e.date,l=null==(t=a.chartData[a.chartData.length-1])?void 0:t.date;return console.log("\uD83D\uDD0D DEBUGGING: Python data range: ".concat(s," to ").concat(l)),a.chartData}}}catch(e){console.log("Python service unavailable, trying direct market APIs...")}let l=K.symbols.map(async e=>{try{console.log("\uD83D\uDD0D DEBUGGING: Fetching historical data for ".concat(e," from ").concat(K.startDate," to ").concat(K.endDate));let a=await fetch("/api/signals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbol:e,startDate:K.startDate,endDate:K.endDate,requestHistorical:!0})});if(a.ok){let l=await a.json();if(console.log("\uD83D\uDD0D DEBUGGING: API response for ".concat(e,":"),l),l.historicalData){if(console.log("\uD83D\uDD0D DEBUGGING: ".concat(e," data points: ").concat(l.historicalData.length)),l.historicalData.length>0){var t,s;let a=null==(t=l.historicalData[0])?void 0:t.date,n=null==(s=l.historicalData[l.historicalData.length-1])?void 0:s.date;console.log("\uD83D\uDD0D DEBUGGING: ".concat(e," date range: ").concat(a," to ").concat(n))}return{symbol:e,historicalData:l.historicalData}}}throw Error("No historical data for ".concat(e))}catch(t){return console.error("Failed to fetch real historical data for ".concat(e,":"),t),{symbol:e,historicalData:null}}}),n=await Promise.all(l),i={},r=!1;if(n.forEach(e=>{let{symbol:t,historicalData:s}=e;s&&Array.isArray(s)&&(i[t]=s,r=!0)}),r){console.log("\uD83D\uDD0D DEBUGGING: Processing real historical market data...");let e=[],t=new Set;Object.values(i).forEach(e=>{e.forEach(e=>{e.date&&t.add(e.date)})});let l=Array.from(t).sort();if(console.log("\uD83D\uDD0D DEBUGGING: Total unique dates found: ".concat(l.length)),console.log("\uD83D\uDD0D DEBUGGING: Date range in data: ".concat(l[0]," to ").concat(l[l.length-1])),l.forEach(t=>{let s={date:t},a=!1;K.symbols.forEach(e=>{let l=i[e];if(l){let n=l.find(e=>e.date===t);n&&(n.close||n.price)&&(s[e]=n.close||n.price,a=!0)}}),a&&e.push(s)}),e.length>0)return console.log("\uD83D\uDD0D DEBUGGING: Final chart data: ".concat(e.length," points")),console.log("\uD83D\uDD0D DEBUGGING: Chart date range: ".concat(null==(s=e[0])?void 0:s.date," to ").concat(null==(a=e[e.length-1])?void 0:a.date)),e}throw Error("REAL DATA REQUIRED: Unable to fetch real historical market data from any source")}catch(e){throw console.error("Real data fetch failed:",e),Error("NO FAKE DATA ALLOWED: Unable to load real market data. Please ensure data services are running.")}},ei=e=>{let t=[];if(e&&e.signals&&e.signals.length>0){let s=new Date(K.startDate),a=new Date(K.endDate),l=new Date,n=[{date:s,changeReason:"Initial"},{date:new Date(s.getTime()+5184e6),changeReason:"Market shift"},{date:new Date(s.getTime()+10368e6),changeReason:"Economic data"},{date:new Date(s.getTime()+15552e6),changeReason:"Fed policy"},{date:new Date(s.getTime()+20736e6),changeReason:"Market volatility"},{date:new Date(s.getTime()+2592e7),changeReason:"Earnings season"},{date:a,changeReason:"Current"}].filter(e=>e.date<=l);K.signals.forEach(s=>{let a=e.signals.find(e=>e.type===s);if(!a)return;let l=!0;n.forEach((e,i)=>{let r=l?"Risk-On":"Risk-Off";l=!l,t.push({date:e.date.toISOString().split("T")[0],strategy:s,signal:r,strength:i===n.length-1?a.strength:"Moderate",confidence:i===n.length-1?a.confidence:.7,changeReason:e.changeReason})})})}return t.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),console.log("Generated signal timeline:",t.length,"events"),t},er=(e,t)=>{let s=[],a={},l=[...t].sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());return l.forEach((t,l)=>{let{strategy:n,signal:i,date:r}=t,d=!a[n],c=a[n]!==i;if(d||c){console.log("Signal change detected: ".concat(n," -> ").concat(i," on ").concat(r)),a[n]=i;let t=e.find(e=>e.date<=r)||e[e.length-1];if(t){let e=K.symbols.filter(e=>{let t=j[e];return"Risk-On"===i?"Risk-On"===t:"Risk-Off"===t});0===e.length&&("Risk-On"===i&&K.symbols.includes("SPY")?e.push("SPY"):"Risk-Off"===i&&K.symbols.includes("XLU")&&e.push("XLU")),e.forEach(e=>{let a=t[e];a&&a>0&&s.push({date:r,action:"BUY",symbol:e,price:a,signal:i,strategy:n,reasoning:"".concat(i," signal triggered for ").concat(n.replace("_","/")," strategy")})})}}}),console.log("Generated ".concat(s.length," trades from ").concat(l.length," signal events")),s},ed=(e,t)=>{if(0===e.length)return{totalReturn:0,annualizedReturn:0,sharpeRatio:0,maxDrawdown:0,winRate:0,totalTrades:0};let s=t,a=t,l=0,n=0;for(let i=0;i<e.length-1;i+=2){let r=e[i],d=e[i+1];if(r&&d&&"BUY"===r.action&&"SELL"===d.action){let e=.1*t/r.price*(d.price-r.price);s+=e,e>0&&n++,l=Math.max(l,((a=Math.max(a,s))-s)/a)}}let i=(s-t)/t,r=Math.floor(e.length/2);return{totalReturn:i,annualizedReturn:.8*i,sharpeRatio:i/Math.max(l,.01),maxDrawdown:-l,winRate:r>0?n/r:0,totalTrades:e.length}};return Z?(0,a.jsx)("div",{className:"w-full h-96 flex items-center justify-center bg-theme-card-secondary border border-theme-border rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-theme-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-theme-text",children:"Running Multi-Strategy Backtesting..."}),(0,a.jsxs)("p",{className:"text-theme-text-muted text-sm mt-2",children:["Analyzing ",K.symbols.length," ETFs with ",K.signals.length," signal",1!==K.signals.length?"s":""]})]})}):ee?(0,a.jsx)("div",{className:"w-full h-96 flex items-center justify-center bg-theme-card-secondary border border-theme-danger-border rounded-lg",children:(0,a.jsxs)("div",{className:"text-center max-w-md",children:[(0,a.jsx)("div",{className:"text-theme-danger text-4xl mb-4",children:"⚠️"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-theme-danger mb-2",children:"Backtesting Error"}),(0,a.jsx)("p",{className:"text-theme-text-muted text-sm mb-4",children:ee}),(0,a.jsx)("button",{onClick:el,className:"px-4 py-2 bg-theme-primary hover:bg-theme-primary-hover text-white rounded-lg transition-colors",children:"Retry Analysis"})]})}):0===K.symbols.length||0===K.signals.length?(0,a.jsx)("div",{className:"w-full h-96 flex items-center justify-center bg-theme-card-secondary border border-theme-border rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-theme-text-muted text-2xl mb-4",children:"\uD83D\uDCCA"}),(0,a.jsx)("p",{className:"text-theme-text-muted",children:"Select ETFs and signals above to see comprehensive backtesting analysis"}),(0,a.jsx)("p",{className:"text-theme-text-light text-sm mt-2",children:"Choose any combination of ETFs and Gayed signals for real data backtesting"}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-theme-text-muted border border-orange-200 bg-orange-50 p-2 rounded",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Debug:"})}),(0,a.jsxs)("p",{children:["Symbols: ",K.symbols.length," (",K.symbols.join(", ")||"none",")"]}),(0,a.jsxs)("p",{children:["Signals: ",K.signals.length," (",K.signals.join(", ")||"none",")"]}),(0,a.jsxs)("p",{children:["Backtest data: ",q?"Available":"None"]}),(0,a.jsxs)("p",{children:["Loading: ",Z?"Yes":"No"]}),(0,a.jsxs)("p",{children:["Error: ",ee||"None"]})]})]})}):q||Z?(0,a.jsxs)("div",{className:"w-full space-y-4",children:[(0,a.jsxs)("div",{className:"bg-theme-card border border-theme-border rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-theme-text",children:null==q?void 0:q.strategy}),(0,a.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Real Market Data"]})]}),(0,a.jsxs)("p",{className:"text-theme-text-muted text-sm",children:[null==q||null==(t=q.timeframe)?void 0:t.start," to ",null==q||null==(s=q.timeframe)?void 0:s.end," • ",null==q||null==(b=q.symbols)?void 0:b.join(", ")]}),(0,a.jsxs)("p",{className:"text-theme-text-light text-xs mt-1",children:["Signals: ",null==q||null==(D=q.signals)?void 0:D.join(", ")]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold ".concat((null!=(A=null==q||null==(v=q.performance)?void 0:v.totalReturn)?A:0)>=0?"text-theme-success":"text-theme-danger"),children:[((null!=(L=null==q||null==(N=q.performance)?void 0:N.totalReturn)?L:0)*100).toFixed(2),"%"]}),(0,a.jsx)("div",{className:"text-theme-text-muted text-sm",children:"Estimated Return"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-theme-text font-medium",children:[((null!=(C=null==q||null==(y=q.performance)?void 0:y.annualizedReturn)?C:0)*100).toFixed(2),"%"]}),(0,a.jsx)("div",{className:"text-theme-text-muted",children:"Annual Return"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-theme-text font-medium",children:(null!=(I=null==q||null==(k=q.performance)?void 0:k.sharpeRatio)?I:0).toFixed(2)}),(0,a.jsx)("div",{className:"text-theme-text-muted",children:"Sharpe Ratio"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-theme-danger font-medium",children:[((null!=(P=null==q||null==(R=q.performance)?void 0:R.maxDrawdown)?P:0)*100).toFixed(2),"%"]}),(0,a.jsx)("div",{className:"text-theme-text-muted",children:"Max Drawdown"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-theme-text font-medium",children:[((null!=(Y=null==q||null==(w=q.performance)?void 0:w.winRate)?Y:0)*100).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-theme-text-muted",children:"Win Rate"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-theme-text font-medium",children:null!=(M=null==q||null==(T=q.performance)?void 0:T.totalTrades)?M:0}),(0,a.jsx)("div",{className:"text-theme-text-muted",children:"Total Trades"})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-1 bg-theme-card p-1 rounded-lg border border-theme-border",children:[(0,a.jsx)("button",{onClick:()=>ea("prices"),className:"px-4 py-2 rounded transition-colors ".concat("prices"===es?"bg-theme-primary text-white":"text-theme-text-muted hover:text-theme-text hover:bg-theme-card-hover"),children:"ETF Prices"}),(0,a.jsx)("button",{onClick:()=>ea("signals"),className:"px-4 py-2 rounded transition-colors ".concat("signals"===es?"bg-theme-primary text-white":"text-theme-text-muted hover:text-theme-text hover:bg-theme-card-hover"),children:"Signal Timeline"}),(0,a.jsx)("button",{onClick:()=>ea("performance"),className:"px-4 py-2 rounded transition-colors ".concat("performance"===es?"bg-theme-primary text-white":"text-theme-text-muted hover:text-theme-text hover:bg-theme-card-hover"),children:"Trading History"})]}),(0,a.jsxs)("div",{className:"bg-theme-card border border-theme-border rounded-xl p-4 chart-container",style:{height:"600px"},children:["prices"===es&&(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"mb-4 p-3 bg-theme-card-secondary rounded-lg border border-theme-border",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-theme-success rounded-full"}),(0,a.jsx)("span",{className:"text-theme-text",children:"Risk-On Signal (Buy Growth ETFs)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-theme-danger rounded-full"}),(0,a.jsx)("span",{className:"text-theme-text",children:"Risk-Off Signal (Buy Defensive ETFs)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-theme-success-bg text-theme-success rounded",children:"BUY"}),(0,a.jsx)("span",{className:"text-theme-text-muted",children:"Buy Signal"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-theme-danger-bg text-theme-danger rounded",children:"SELL"}),(0,a.jsx)("span",{className:"text-theme-text-muted",children:"Sell Signal"})]})]}),(0,a.jsxs)("div",{className:"text-xs text-theme-text-muted",children:["Chart: ",(null==q||null==(S=q.chartData)?void 0:S.length)||0," points | Signals: ",(null==q||null==(O=q.signalTimeline)?void 0:O.length)||0," events | Trades: ",(null==q||null==(E=q.trades)?void 0:E.length)||0," trades"]})]}),(0,a.jsx)("div",{className:"chart-responsive-wrapper flex-1 min-h-0",children:(0,a.jsx)(n.u,{width:"100%",height:"100%",children:(null==q?void 0:q.chartData)&&(null==q||null==(G=q.chartData)?void 0:G.length)!==0?(0,a.jsxs)(i.X,{data:null!=(X=null==q?void 0:q.chartData)?X:[],margin:{top:20,right:30,left:20,bottom:60},children:[(0,a.jsx)(r.d,{strokeDasharray:"3 3",className:"chart-grid-color"}),(0,a.jsx)(d.W,{dataKey:"date",className:"chart-axis-color chart-text-color",tick:{fontSize:12},tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}),angle:-45,textAnchor:"end",height:60}),(0,a.jsx)(c.h,{className:"chart-axis-color chart-text-color",tick:{fontSize:12}}),(0,a.jsx)(o.m,{content:(0,a.jsx)(e=>{let{active:t,payload:s,label:l}=e;if(t&&s&&s.length){let e=s[0].payload,t=null==q?void 0:q.signalTimeline.find(e=>new Date(e.date).getTime()<=new Date(l).getTime());return(0,a.jsxs)("div",{className:"bg-theme-card border border-theme-border rounded-lg p-3 shadow-lg max-w-xs",children:[(0,a.jsx)("p",{className:"text-theme-text font-medium mb-2",children:new Date(l).toLocaleDateString()}),t&&(0,a.jsxs)("div",{className:"mb-3 p-2 rounded",style:{backgroundColor:"Risk-On"===t.signal?"#10B981":"#EF4444",opacity:.1},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"Risk-On"===t.signal?"#10B981":"#EF4444"}}),(0,a.jsxs)("span",{className:"text-theme-text font-medium text-sm",children:["Market Signal: ",t.signal]})]}),(0,a.jsxs)("p",{className:"text-xs text-theme-text-muted",children:["Strategy: ",t.strategy.replace("_","/")]})]}),(0,a.jsx)("div",{className:"space-y-1 mb-2",children:K.symbols.map(s=>{let l=j[s],n=e[s],i=t&&("Risk-On"===t.signal&&"Risk-On"===l||"Risk-Off"===t.signal&&"Risk-Off"===l);return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{style:{color:p(s,"Risk-On"===l)},className:"font-medium",children:s}),(0,a.jsx)("span",{className:"text-xs px-1 py-0.5 rounded ".concat("Risk-On"===l?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"),children:l}),i&&(0,a.jsx)("span",{className:"text-xs px-1 py-0.5 bg-green-100 text-green-800 rounded font-medium",children:"BUY"})]}),(0,a.jsxs)("span",{className:"text-theme-text",children:["$",(null==n?void 0:n.toFixed(2))||"N/A"]})]},s)})}),t&&(0,a.jsx)("div",{className:"border-t border-theme-border pt-2 text-xs text-theme-text-muted",children:(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[t.signal," Signal:"]})," Buy"," ","Risk-On"===t.signal?"growth-oriented":"defensive"," ETFs"]})})]})}return null},{})}),(0,a.jsx)(m.s,{}),(null==q?void 0:q.signalTimeline)&&(null==q||null==(B=q.signalTimeline)?void 0:B.length)>0&&(()=>{var e,t,s,l,n,i,r,d,c,o,m;let h=[],g=(null!=(r=null==q?void 0:q.chartData)?r:[]).slice(0,3).map(e=>e.date),u=(null!=(d=null==q?void 0:q.signalTimeline)?d:[]).slice(0,3).map(e=>e.date);console.log("\uD83D\uDD0D DEBUGGING: Chart data dates:",g),console.log("\uD83D\uDD0D DEBUGGING: Signal timeline dates:",u);for(let t=0;t<(null!=(c=null==q||null==(e=q.signalTimeline)?void 0:e.length)?c:0)-1;t++){let e=null==q||null==(o=q.signalTimeline)?void 0:o[t],s=null==q||null==(m=q.signalTimeline)?void 0:m[t+1],a=e.date.includes("T")?e.date.split("T")[0]:e.date,l=s.date.includes("T")?s.date.split("T")[0]:s.date;h.push({start:a,end:l,signal:e.signal,key:"zone-".concat(t)})}let f=null==q||null==(s=q.signalTimeline)?void 0:s[(null==q||null==(t=q.signalTimeline)?void 0:t.length)-1],p=null==q||null==(i=q.chartData)||null==(l=i[(null==q||null==(n=q.chartData)?void 0:n.length)-1])?void 0:l.date;if(f&&p){let e=f.date.includes("T")?f.date.split("T")[0]:f.date,t=p.includes("T")?p.split("T")[0]:p;h.push({start:e,end:t,signal:f.signal,key:"zone-last"})}return console.log("\uD83D\uDD0D DEBUGGING: Generated ".concat(h.length," signal zones:"),h),h.map(e=>(0,a.jsx)(x.T,{x1:e.start,x2:e.end,fill:"Risk-On"===e.signal?"#10B981":"#EF4444",fillOpacity:.15,stroke:"none"},e.key))})(),K.symbols.map(e=>{let t=j[e],s="Risk-On"===t;return(0,a.jsx)(h.N,{type:"monotone",dataKey:e,stroke:p(e,s),strokeWidth:s?3:2,strokeDasharray:s?"0":"5 5",name:"".concat(e," (").concat(t,")"),dot:!1},e)}),(null==q?void 0:q.trades)&&(null!=(z=null==q?void 0:q.trades)?z:[]).slice(0,10).map((e,t)=>{let s=e.date.includes("T")?e.date.split("T")[0]:e.date;return console.log("\uD83D\uDD0D DEBUGGING: Rendering trade marker ".concat(t," at date ").concat(s," for ").concat(e.action," ").concat(e.symbol)),(0,a.jsx)(g.e,{x:s,stroke:"BUY"===e.action?"#10B981":"#EF4444",strokeWidth:2,strokeDasharray:"5 5",label:{value:"".concat(e.action," ").concat(e.symbol),position:"BUY"===e.action?"bottom":"top",style:{fontSize:"10px",fill:"BUY"===e.action?"#10B981":"#EF4444",fontWeight:"bold"}}},"trade-".concat(t))}),(null!=(W=null==q?void 0:q.signalTimeline)?W:[]).map((e,t)=>{let s=e.date.includes("T")?e.date.split("T")[0]:e.date;return console.log("\uD83D\uDD0D DEBUGGING: Rendering signal marker ".concat(t," at date ").concat(s," for ").concat(e.signal)),(0,a.jsx)(g.e,{x:s,stroke:"Risk-On"===e.signal?"#10B981":"#EF4444",strokeWidth:3,strokeDasharray:"0",label:{value:"".concat(e.signal),position:"Risk-On"===e.signal?"bottom":"top",style:{fontSize:"12px",fontWeight:"bold",fill:"Risk-On"===e.signal?"#10B981":"#EF4444",background:"#ffffff",padding:"2px 4px",borderRadius:"3px"}}},"signal-".concat(t))})]}):(0,a.jsxs)(i.X,{data:[{date:"2024-01-01",SPY:470,XLU:75},{date:"2024-02-01",SPY:480,XLU:77},{date:"2024-03-01",SPY:490,XLU:78},{date:"2024-04-01",SPY:495,XLU:80},{date:"2024-05-01",SPY:510,XLU:82}],margin:{top:20,right:30,left:20,bottom:60},children:[(0,a.jsx)(r.d,{strokeDasharray:"3 3",stroke:"#374151"}),(0,a.jsx)(d.W,{dataKey:"date",stroke:"#9CA3AF",tick:{fontSize:12}}),(0,a.jsx)(c.h,{stroke:"#9CA3AF",tick:{fontSize:12}}),(0,a.jsx)(o.m,{}),(0,a.jsx)(m.s,{}),(0,a.jsx)(h.N,{type:"monotone",dataKey:"SPY",stroke:"#3B82F6",strokeWidth:2,name:"SPY (Test Data)"}),(0,a.jsx)(h.N,{type:"monotone",dataKey:"XLU",stroke:"#F59E0B",strokeWidth:2,name:"XLU (Test Data)"})]})})})]}),"signals"===es&&(0,a.jsxs)("div",{className:"h-full space-y-4 overflow-y-auto",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-theme-text",children:"Current Signal Status"}),(null!=(Q=null==q||null==(F=q.signalTimeline)?void 0:F.length)?Q:0)===0?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("div",{className:"text-theme-text-muted mb-4",children:[(0,a.jsx)(u.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Live Signal Data"}),(0,a.jsx)("p",{className:"text-sm",children:"Signals are updated in real-time from the current market session"})]}),(0,a.jsx)("div",{className:"text-sm text-theme-text-light",children:"Check the Strategy Dashboard for current signal states across all strategies"})]}):(0,a.jsx)("div",{className:"space-y-2",children:(null!=(V=null==q?void 0:q.signalTimeline)?V:[]).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-theme-card-secondary rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"px-2 py-1 rounded text-xs font-medium ".concat("Risk-On"===e.signal?"bg-theme-success-bg text-theme-success":"bg-theme-danger-bg text-theme-danger"),children:e.signal}),(0,a.jsx)("div",{className:"text-theme-text font-medium",children:e.strategy.replace("_","/")}),(0,a.jsx)("div",{className:"text-theme-text-muted text-sm",children:new Date(e.date).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-theme-text text-sm",children:e.strength}),(0,a.jsxs)("div",{className:"text-xs text-theme-text-muted",children:[(100*e.confidence).toFixed(1),"% confidence"]})]})]},t))}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-theme-info-bg border border-theme-info-border rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(f.A,{className:"w-5 h-5 text-theme-info flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-theme-text-secondary",children:[(0,a.jsx)("p",{className:"font-medium text-theme-info mb-1",children:"Signal Information"}),(0,a.jsx)("p",{children:"This shows current signal states for selected strategies. Historical signal changes are used to generate the trading timeline. For real-time signal monitoring, visit the main Strategy Dashboard."})]})]})})]}),"performance"===es&&(0,a.jsxs)("div",{className:"h-full space-y-4 overflow-y-auto",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-theme-text",children:"Trading History"}),(null!=(_=null==q||null==(U=q.trades)?void 0:U.length)?_:0)===0?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("div",{className:"text-theme-text-muted mb-4",children:[(0,a.jsx)(u.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Signal-Based Trading"}),(0,a.jsx)("p",{className:"text-sm",children:"Trading decisions are generated based on signal changes"})]}),(0,a.jsx)("div",{className:"text-sm text-theme-text-light",children:"Select signals above to see how they would trigger ETF trades based on Risk-On/Risk-Off signals"}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 text-left",children:[(0,a.jsxs)("div",{className:"p-4 bg-theme-success-bg border border-theme-success-border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-theme-success rounded-full"}),(0,a.jsx)("span",{className:"font-medium text-theme-success",children:"Risk-On Signals"})]}),(0,a.jsx)("p",{className:"text-sm text-theme-text-secondary",children:"Trigger BUY orders for growth-oriented ETFs (SPY, QQQ, VTI, etc.)"})]}),(0,a.jsxs)("div",{className:"p-4 bg-theme-danger-bg border border-theme-danger-border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-theme-danger rounded-full"}),(0,a.jsx)("span",{className:"font-medium text-theme-danger",children:"Risk-Off Signals"})]}),(0,a.jsx)("p",{className:"text-sm text-theme-text-secondary",children:"Trigger BUY orders for defensive ETFs (XLU, TLT, GLD, etc.)"})]})]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(null!=(H=null==q?void 0:q.trades)?H:[]).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-theme-card-secondary rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"px-2 py-1 rounded text-xs font-medium ".concat("BUY"===e.action?"bg-theme-success-bg text-theme-success":"bg-theme-danger-bg text-theme-danger"),children:e.action}),(0,a.jsx)("div",{className:"text-theme-text font-medium",children:e.symbol}),(0,a.jsx)("div",{className:"text-theme-text-muted text-sm",children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-xs text-theme-text-muted",children:e.strategy.replace("_","/")})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-theme-text",children:["$",e.price.toFixed(2)]}),(0,a.jsx)("div",{className:"text-xs ".concat("Risk-On"===e.signal?"text-theme-success":"text-theme-danger"),children:e.signal})]})]},t)),(0,a.jsx)("div",{className:"mt-6 p-4 bg-theme-info-bg border border-theme-info-border rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(f.A,{className:"w-5 h-5 text-theme-info flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-theme-text-secondary",children:[(0,a.jsx)("p",{className:"font-medium text-theme-info mb-1",children:"Trading Logic"}),(0,a.jsx)("p",{children:"Trades are generated when signals change state. Risk-On signals trigger purchases of growth ETFs, while Risk-Off signals trigger purchases of defensive assets. Portfolio allocations from your Strategy Dashboard determine position sizes."})]})]})})]})]})]}),(0,a.jsxs)("div",{className:"bg-theme-card border border-theme-border rounded-xl p-4",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-theme-text mb-3",children:"\uD83D\uDCCA Selected ETFs by Risk Classification"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,a.jsx)("h5",{className:"font-medium text-green-800",children:"Risk-On ETFs (Growth Assets)"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[K.symbols.filter(e=>"Risk-On"===j[e]).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-green-700",children:e}),(0,a.jsx)("span",{className:"text-xs text-green-600",children:"Solid line"})]},e)),0===K.symbols.filter(e=>"Risk-On"===j[e]).length&&(0,a.jsx)("p",{className:"text-sm text-green-600 italic",children:"No Risk-On ETFs selected"})]}),(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"\uD83D\uDCC8 Buy during Risk-On signals (green zones)"})]}),(0,a.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,a.jsx)("h5",{className:"font-medium text-red-800",children:"Risk-Off ETFs (Defensive Assets)"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[K.symbols.filter(e=>"Risk-Off"===j[e]).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-red-700",children:e}),(0,a.jsx)("span",{className:"text-xs text-red-600",children:"Dashed line"})]},e)),0===K.symbols.filter(e=>"Risk-Off"===j[e]).length&&(0,a.jsx)("p",{className:"text-sm text-red-600 italic",children:"No Risk-Off ETFs selected"})]}),(0,a.jsx)("p",{className:"text-xs text-red-600 mt-2",children:"\uD83D\uDEE1️ Buy during Risk-Off signals (red zones)"})]})]}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h5",{className:"font-medium text-blue-800 mb-2",children:"\uD83D\uDCA1 How the Signal System Works"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Green Zones (Risk-On):"})," Market conditions favor growth → Buy SPY, QQQ, VTI, WOOD, etc."]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Red Zones (Risk-Off):"})," Market conditions favor safety → Buy XLU, GLD, TLT, SPLV, etc."]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Signal Changes:"})," Vertical lines show when the strategy flips between Risk-On and Risk-Off"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Buy/Sell Markers:"})," Green circles = Buy signals, Red triangles = Sell signals"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-theme-info-bg border border-theme-info-border rounded-xl p-4",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-theme-info mb-2",children:"Multi-Strategy Analysis"}),(0,a.jsxs)("div",{className:"text-sm text-theme-text-secondary space-y-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Active Signals:"})," ",K.signals.join(", ")]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Analysis Period:"})," ",K.startDate," to ",K.endDate]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Portfolio Allocations:"})," ",Object.entries(K.allocations).filter(e=>{let[t,s]=e;return s>0}).map(e=>{let[t,s]=e;return"".concat(t,":").concat(s,"%")}).join(", ")||"Equal weighted"]})]})]})]}):(0,a.jsx)("div",{className:"w-full h-96 flex items-center justify-center bg-theme-card-secondary border border-theme-border rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-theme-text-muted text-2xl mb-4",children:"\uD83D\uDD04"}),(0,a.jsx)("p",{className:"text-theme-text-muted",children:"Chart should load but data is missing"}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-theme-text-muted border border-red-200 bg-red-50 p-2 rounded",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Debug Info:"})}),(0,a.jsxs)("p",{children:["Config valid: ",K.symbols.length>0&&K.signals.length>0?"Yes":"No"]}),(0,a.jsxs)("p",{children:["Symbols: ",K.symbols.join(", ")]}),(0,a.jsxs)("p",{children:["Signals: ",K.signals.join(", ")]}),(0,a.jsxs)("p",{children:["Start Date: ",K.startDate]}),(0,a.jsxs)("p",{children:["End Date: ",K.endDate]}),(0,a.jsxs)("p",{children:["Backtest Data: ",q?"Available":"Missing"]}),(0,a.jsxs)("p",{children:["Loading: ",Z?"Yes":"No"]}),(0,a.jsxs)("p",{children:["Error: ",ee||"None"]})]})]})})}}}]);